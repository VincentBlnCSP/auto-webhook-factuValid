<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Données Facturation</title>
</head>
<body>

  <pre id="output">Chargement...</pre>

  <script>
    const dealId = new URLSearchParams(window.location.search).get("deal_id");
    const output = document.getElementById("output");

    if (!dealId) {
      output.textContent = "❌ Aucun ID d'affaire fourni dans l'URL.";
    } else {
      fetch("https://hook.eu2.make.com/4n43s44ulig2di1my33gqmelal2itulh", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ deal_id: dealId })
      })
      .then(response => response.json())
      .then(data => {
        output.textContent = JSON.stringify(data, null, 2); // Affiche tout proprement
      })
      .catch(error => {
        output.textContent = "❌ Erreur lors de la récupération : " + error;
      });
    }
  </script>

</body>
</html>
